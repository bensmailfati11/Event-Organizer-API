<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{title}}</title>
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Simple reveal animation */
      .reveal{opacity:0;transform:translateY(12px);transition:opacity .6s ease,transform .6s ease}
      .reveal.is-visible{opacity:1;transform:none}
      /* Soft glow on hover */
      .glow:hover{box-shadow:0 10px 25px -5px rgba(99,102,241,.25),0 8px 10px -6px rgba(99,102,241,.2)}
    </style>
  </head>
  <body class="min-h-screen bg-gray-50 text-gray-800">
    <header class="bg-white border-b">
      <nav class="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between">
        <a href="/" class="text-lg font-semibold text-indigo-600">Event Organizer</a>
        <div class="flex items-center gap-4">
          <a href="/events" class="text-sm text-gray-600 hover:text-gray-900">Events</a>
          {{#if user}}
            <a href="/member" class="text-sm text-gray-600 hover:text-gray-900">Member</a>
            {{#if (eq user.role "admin")}}
              <a href="/admin" class="text-sm text-gray-600 hover:text-gray-900">Admin</a>
            {{/if}}
            <a href="/logout" class="inline-flex items-center rounded-md bg-gray-100 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-200">Logout</a>
          {{else}}
            <a href="/login" class="inline-flex items-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-indigo-700">Login</a>
          {{/if}}
        </div>
      </nav>
    </header>

    <main class="mx-auto max-w-6xl px-4 py-8 reveal">
      {{{body}}}
    </main>

    <footer class="mt-16 border-t bg-white">
      <div class="mx-auto max-w-6xl px-4 py-6 text-sm text-gray-500">
        Built with Express, Mongoose, and Handlebars.
      </div>
    </footer>

    <script>
      // Mirror server-verified token for client-side API calls when present
      window.SERVER_TOKEN = {{#if token}}"{{token}}"{{else}}null{{/if}};
      if (window.SERVER_TOKEN && !localStorage.getItem('token')) {
        try { localStorage.setItem('token', window.SERVER_TOKEN); } catch (_) {}
      }
      // IntersectionObserver to reveal elements
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('is-visible'); io.unobserve(e.target);} });
      },{threshold:0.12});
      document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
    </script>
  </body>
</html>
